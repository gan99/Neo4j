<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Neo4j Graph Visualization</title>
    <link rel="stylesheet" href="styles.css">
    <script src="https://unpkg.com/neovis.js@2.0.2"></script>
    <script src="https://code.jquery.com/jquery-3.2.1.min.js"
            integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4="
            crossorigin="anonymous"></script>
</head>
<body>
    <nav class="navbar">
        <h1>Graph Visualization</h1>
        <div class="search-container">
            <select id="searchLabel">
                <option value="Account">Account</option>
                <option value="Transaction">Transaction</option>
              
            </select>
            <input type="text" id="searchInput" placeholder="Enter acc or transaction...">
            <button onclick="searchNode()">Search</button>
        </div>
    </nav>

    <div class="container">
        <div class="filters">
            <h3>Filter by Node Label</h3>
            <button onclick="filterNodes('Account')">Account</button>
            <button onclick="filterNodes('Transaction')">Transaction</button>
            

            <h3>Filter by Relationship Type</h3>
            <button onclick="filterRelationships('INITIATED')">INITIATED</button>
            <button onclick="filterRelationships('SENT_TO')">SENT_TO</button>
            

            <h3>Node Limit</h3>
            <input type="number" id="nodeLimit" value="100" min="1" max="1000">

            <h3>Actions</h3>
            <button onclick="resetVisualization()">Reset</button>
            <h3>Click on Reset button</h3>
        </div>

        <div id="viz"></div>
    </div>

    <footer class="footer">
        <p>Bank Transaction Visualization</p>
    </footer>

    <script src="scriptss.js"></script>
</body>
</html>

MATCH (client:Party {name: $clientName})
MATCH (client)-[:IS_PAYOR_OF|IS_PAYEE_OF]->(tx:Transaction)<-[:IS_PAYOR_OF|IS_PAYEE_OF]-(counterparty:Party)
WHERE client <> counterparty
  AND tx.date >= date($startDate)
  AND tx.date <= date($endDate)
MATCH (counterparty)-[:IS_CUSTOMER_OF]->(fi:FinancialInstitution)
WITH counterparty, tx, fi
RETURN fi.fi_name_std AS counterpartyBank,
       counterparty.party_name AS counterpartyName,
       SUM(tx.amount) AS totalValue,
       COUNT(tx) AS transactionCount,
       CASE WHEN fi.fi_name_std = 'BMO' THEN true ELSE false END AS isBMOClient
ORDER BY counterpartyBank, totalValue DESC
LIMIT $topN
