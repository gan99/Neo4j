CALL {
  MATCH (n:Client)
  WITH n.id AS id, COLLECT(n) AS nodes
  WHERE SIZE(nodes) > 1
  CALL {
    WITH nodes
    UNWIND tail(nodes) AS toDelete
    DETACH DELETE toDelete
  }
} IN TRANSACTIONS OF 10000 ROWS;
